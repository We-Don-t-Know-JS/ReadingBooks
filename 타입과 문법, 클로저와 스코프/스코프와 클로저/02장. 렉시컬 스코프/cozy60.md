# 렉시컬 스코프

스코프는 두 가지 방식으로 작동한다. 첫 번째는 렉시컬 스코프, 두 번째는 동적 스코프 이다. 자바스크립트에선 렉시컬 스코프를 차용한다.

## 렉스타임

렉싱 처리 과정에서 소스 코드 문자열을 분석해 상태 유지 파싱의 결과로 생성된 토큰에 의미를 부여한다. 이 개념이 렉시컬 스코프가 무엇인지, 어원이 어디인지를 알게 해주는 바탕이 된다.

순환적인 정의를 하자면 렉시컬 스코프는 렉싱 타임에 정의되는 정적 스코프다. 바꿔 말하면 렉시컬 스코프는 개발자가 코드를 짤 때 변수와 스코프 블록을 어디서 작성하는가에 기초해 렉서가 코드를 처리할 때 확정된다.

스코프 블록은 서로 중첩될 수 있다. 그러나 어떤 함수의 버블도 동시에 다른 두 스코프 버블 안에 존재할 수 없다. 어떤 함수도 두 개의 부모 함수 안에 존재할 수 없는 것 처럼 말이다.

### 검색

엔진은 스코프 버블의 구조와 상대적 위치를 통해 어디를 검색해야 확인자를 찾을 수 있는지 안다.
검색은 가장 안쪽의 스코프 버블에서 시작한다. 여기서 변수를 찾지 못하면 다음으로 가장 가까운 스코프 버블로 한 단계 올라가고, 변수가 있으면 찾아 사용한다.
스코프는 목표와 일치하는 대상을 찾는 즉시 검색을 중단한다. 이를 섀도잉 이라고 한다. 섀도잉과 상관없이 스코프 검색은 항상 실행 시점에서 가장 안쪽 스코프에서 시작해 최초 목표와 일치하는 대상을 찾으면 멈추고, 그전까지는 바깥/위로 올라가면서 실행한다.

글로벌 변수는 자동으로 웹 브라우저의 window 같은 글로벌 객체에 속한다. 따라서 글로벌 변수를 직접 렉시컬 이름으로 참조하는 것뿐만 아니라 글로벌 객체의 속성을 참조해 간접적으로 참조할 수도 있다.
글로벌 변수에는 `window.변수명`을 통해 접근할 수 있다. 가려져 있어 다른 방식으로 접근할 수 없는 글로벌 변수에는 이 방법을 통해 접근할 수 있다. 그래서 글로벌이 아닌 섀도 변수는 접근할 수 없다.

어떤 함수가 어디서 또는 어떻게 호출되는지에 상관없이 함수의 렉시컬 스코프는 함수가 선언된 위치에 따라 정의된다.

## 렉시컬 속이기

### eval()

### with

### 성능

## 정리

렉시컬 스코프란 개발자가 코드를 작성할 때 함수를 어디에 선언하는지에 따라 정의되는 스코프를 말한다.
컴파일레이션의 렉싱 단계에서는 모든 확인자가 어디서 어떻게 선언됐는지 파악해 실행 단계에서 어떻게 확인자를 검색할지 예상할 수 있도록 도와준다.
